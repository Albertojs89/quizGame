<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>HeroQuest ‚Äì Sala de los Pasos Fugaces</title>

<style>
body{
  margin:0;
  min-height:100vh;
  display:grid;
  place-items:center;
  background:#0b0e14;
  font-family:system-ui, sans-serif;
  color:#eee;
}

.wrap{
  background:#121827;
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px;
  padding:16px;
  width:320px;
}

h1{
  font-size:14px;
  margin:0 0 8px;
  text-align:center;
  font-weight:600;
}

.hud{
  display:flex;
  justify-content:space-between;
  font-size:13px;
  margin-bottom:10px;
  color:#ccc;
}

.board{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  grid-template-rows:repeat(5,1fr);
  gap:8px;
}

.tile{
  aspect-ratio:1/1;
  border-radius:10px;
  background:#1a2438;
  border:1px solid rgba(255,255,255,.08);
  cursor:pointer;
  transition:
    background-color .18s ease,
    box-shadow .18s ease;
}

/* iluminaci√≥n suave */
.tile.flash{
  background:#ffd500;
  box-shadow:0 0 14px rgba(255,213,0,.6);
}

/* patr√≥n fijo (m√°ster) */
.tile.pattern{
  background:#d6c15a;
  box-shadow:0 0 10px rgba(255,213,0,.35);
}

.tile.correct{
  background:#c9b400;
}

.tile.wrong{
  background:#a03030;
  box-shadow:0 0 16px rgba(255,60,60,.6);
}

button{
  margin-top:8px;
  width:100%;
  padding:8px;
  background:#1f2a44;
  border:1px solid rgba(255,255,255,.15);
  border-radius:8px;
  color:#eee;
  font-weight:600;
  cursor:pointer;
}

button.secondary{
  background:#182036;
}

.footer{
  margin-top:8px;
  font-size:12px;
  color:#aaa;
  text-align:center;
}
</style>
</head>

<body>
<div class="wrap">
  <h1>Sala de los Pasos Fugaces</h1>

  <div class="hud">
    <div>‚ù§Ô∏è Vidas: <b id="hp">3</b></div>
    <div>üß† Paso: <b id="step">0</b></div>
  </div>

  <div class="board" id="board"></div>

  <button id="start">Iniciar secuencia</button>
  <button id="show" class="secondary">Mostrar patr√≥n (m√°ster)</button>

  <div class="footer">
    Empieza abajo. Termina arriba.
  </div>
</div>

<script>
const COLS = 3;
const ROWS = 5;
const FLASH_MS = 140;
const GAP_MS   = 40;

/* üîí Patr√≥n FIJO */
const PATH = [
  {x:1,y:4},
  {x:0,y:4},
  {x:0,y:3},
  {x:1,y:3},
  {x:2,y:3},
  {x:2,y:2},
  {x:1,y:2},
  {x:1,y:1},
  {x:0,y:1},
  {x:1,y:1},
  {x:1,y:0}
];

let lives = 3;
let step = 0;
let active = false;
let tiles = [];

const board = document.getElementById("board");
const hpEl = document.getElementById("hp");
const stepEl = document.getElementById("step");

function idx(x,y){ return y*COLS+x }

function build(){
  board.innerHTML="";
  tiles=[];
  for(let y=0;y<ROWS;y++){
    for(let x=0;x<COLS;x++){
      const t=document.createElement("div");
      t.className="tile";
      t.dataset.x=x;
      t.dataset.y=y;
      t.onclick=()=>clickTile(x,y,t);
      board.appendChild(t);
      tiles.push(t);
    }
  }
}

function clearStates(){
  tiles.forEach(t=>{
    t.classList.remove("flash","correct","wrong","pattern");
  });
}

async function flash(){
  active=false;
  step=0;
  stepEl.textContent=step;
  clearStates();

  for(const c of PATH){
    const t=tiles[idx(c.x,c.y)];
    t.classList.add("flash");
    await wait(FLASH_MS);
    t.classList.remove("flash");
    await wait(GAP_MS);
  }

  active=true;
}

/* üëÅÔ∏è Mostrar patr√≥n fijo */
function showPattern(){
  active=false;
  step=0;
  stepEl.textContent=step;
  clearStates();

  for(const c of PATH){
    tiles[idx(c.x,c.y)].classList.add("pattern");
  }
}

function clickTile(x,y,t){
  if(!active) return;

  const exp = PATH[step];
 
  if(x===exp.x && y===exp.y){
    t.classList.add("correct");
    step++;
    stepEl.textContent=step;

    if(step===PATH.length){
      active=false;
      alert("‚úî El cofre se abre");
    }
  }else{
    t.classList.add("wrong");
    active=false;
    lives--;
    hpEl.textContent=lives;
    if(lives<=0){
      alert("‚ò† Sin vidas");
      return;
    }
    setTimeout(flash,350);
  }
}

function wait(ms){ return new Promise(r=>setTimeout(r,ms)) }

document.getElementById("start").onclick=flash;
document.getElementById("show").onclick=showPattern;

build();

</script>
</body>
</html>
